"use strict";class OneLinkUrlGenerator{constructor({oneLinkURL:e,pidKeysList:a=[],pidStaticValue:r=null,campaignKeysList:t=[],campaignStaticValue:s=null,pidOverrideList:i=[],gclIdParam:n="af_sub5"}={}){if(console.debug("Constructing OneLink URL generator"),void 0===e||"string"!=typeof e||""===e)return console.error("OneLinkUrlGenerator: oneLinkURL arg invalid"),null;this.oneLinkURL=e,this.pidOverrideList=i,this.gclIdParam=n,this.pidKeysList=a,this.pidStaticValue=r,this.campaignKeysList=t,this.campaignStaticValue=s,this.campaign=getCampaignValue(this.campaignKeysList,this.campaignStaticValue),this.mediaSource=getMediaSourceValue(this.pidKeysList,this.pidStaticValue,this.pidOverrideList),this.afParams={af_js_web:"true"}}generateUrl(){if(getParameterFromURL("af_redirect"))return console.debug("This user comes from AppsFlyer by redirection and is ready to be attributed. \nKeep direct app store links."),null;let e=this.mediaSource;const a=getParameterFromURL("gclid");if(a){this.afParams[this.gclIdParam]=a,console.debug("This user comes from Google AdWords");const e=getParameterFromURL("keyword");e&&(this.afParams.af_keywords=e,console.debug("There is a keyword associated with the ad"))}else console.debug("This user comes from SRN or custom network ");const r=this.oneLinkURL+"?pid="+e+"&c="+this.campaign+stringifyAfParameters(this.afParams);return console.debug(`Generated OneLink URL ${r}`),r}setDeepLinkValue(e,a=null){setGenericParameter(this.afParams,"deep_link_value",e,a)}setChannel(e,a=null){setGenericParameter(this.afParams,"af_channel",e,a)}setAdset(e,a=null){setGenericParameter(this.afParams,"af_adset",e,a)}setAd(e,a=null){setGenericParameter(this.afParams,"af_ad",e,a)}setAfSub1(e,a=null){setGenericParameter(this.afParams,"af_sub1",e,a)}setAfSub2(e,a=null){setGenericParameter(this.afParams,"af_sub2",e,a)}setAfSub3(e,a=null){setGenericParameter(this.afParams,"af_sub3",e,a)}setAfSub4(e,a=null){setGenericParameter(this.afParams,"af_sub4",e,a)}setAfSub5(e,a=null){setGenericParameter(this.afParams,"af_sub5",e,a)}setIsReTargeting(e,a){setGenericParameter(this.afParams,"is_retargeting",e,a)}setAfPModPriority(e,a){setGenericParameter(this.afParams,"af_pmod_priority",e,a)}setAfPModLookBackWindow(e,a){setGenericParameter(this.afParams,"af_pmod_lookback_window",e,a)}setAfAndroidUrl(e,a){setGenericParameter(this.afParams,"af_android_url",e,a)}setC(e,a){setGenericParameter(this.afParams,"c",e,a)}setCustomPId(e){this.mediaSource=e}setCustomParameter(e,a,r=null){setGenericParameter(this.afParams,a,e,r)}}function isFacebook(){return!(!document.referrer||""==document.referrer)&&document.referrer.toLowerCase().includes("facebook")}function getParameterFromURL(e){const a=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(a);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}function getMediaSourceValue(e,a,r){let t=null;for(let a of e)null!=a&&getParameterFromURL(a)&&(t=getParameterFromURL(a));return null!=t?r.hasOwnProperty(t)&&(t=r[t]):t=a,t}function getCampaignValue(e,a){for(let a of e)if(getParameterFromURL(a))return getParameterFromURL(a);return null!=a?a:document.getElementsByTagName("title")[0]?document.getElementsByTagName("title")[0].innerText:"unknown"}function stringifyAfParameters(e){let a="";for(var r of Object.keys(e))console.debug(r+"->"+e[r]),null!=e[r]&&(a+=`&${r}=${e[r]}`);return a}function setGenericParameter(e,a,r,t=null){const s=getParameterFromURL(r);s?(e[a]=s,console.debug(`${r} found. ${a} = ${s}`)):null!=t?(e[a]=t,console.debug(`${r} not found. ${a} = ${t}`)):console.debug(`${r} not found and newParamValue is null. Skipping.`)}window.AF=Object.assign(window.AF||{},{OneLinkUrlGenerator:OneLinkUrlGenerator});